{% extends '::PrincipalBase.html.twig' %}

{% block principal -%}
    
    <!-- Botón ayuda -->
    <a href="#help" class="btn pull-right tool" data-toggle="modal" title="Click para ayuda"><i class="icon-question-sign"></i></a>
    
    <h3 class="text-center">Ingreso de seguro de vida</h3>
    
    <!-- Contenido ayuda -->
    <div id="help" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="helpLabel" aria-hidden="true">
      <div class="modal-header">
       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
       <h3 id="helpLabel">Seguro de vida</h3>
      </div>
      <div class="modal-body">
       <p>¿Cómo llenar este formulario?</p>
       <p>Se describen a continuación los pasos necesarios</p>
      </div>
      <div class="modal-footer">
       <button class="btn" data-dismiss="modal" aria-hidden="true">Cerrar</button>
      </div>
    </div>
    <!-- fin Ayuda -->

    <form action="{{ path('segurovida_create') }}" id= "seguro_form" class="form-horizontal" method="post" {{ form_enctype(form) }}>
    
    {#Formulario principal#}
       <fieldset>
           <legend>Datos Generales</legend>
            <div>
                {{ form_row(form.fechaseguro)}}
                {{ form_row(form.estadoseguro)}}
                {{ form_row(form.idexpediente)}}
           </div>
       </fieldset>
    
    {#Formulario embebido#}
       <fieldset>
                <legend>Beneficiarios</legend>
                <ul class="Beneficiario unstyled" data-prototype="
                <table>
                <tr>
                <td>{{ form_label(form.idbeneficiario.vars.prototype.nombrebeneficiario)|e }}</td>
                <td>{{ form_label(form.idbeneficiario.vars.prototype.parentescobeneficiario)|e }}</td>
                <td>{{ form_label(form.idbeneficiario.vars.prototype.porcentaje)|e }}</td>
                
                </tr>
                <tr>
                <td>{{ form_widget(form.idbeneficiario.vars.prototype.nombrebeneficiario)|e }}</td>
                <td>{{ form_widget(form.idbeneficiario.vars.prototype.parentescobeneficiario)|e }}</td>
                <td>{{ form_widget(form.idbeneficiario.vars.prototype.porcentaje)|e }}</td>
                </tr>
                </table>
                ">
                 <li> {{form_widget(form.idbeneficiario[0])}} </li>

                </ul>
       </fieldset>    
        <div class="centered">
            <button type="submit" class="btn btn-primary">Guardar</button>
            <button type="reset"  class="btn">Cancelar</button> 
        </div>
    {{ form_rest(form) }}
    </form>

<script>   
/************************************* Beneficiarios **********************************/

// Obtiene la ul que contiene la colección de etiquetas
var collectionHolderBen = $('ul.Beneficiario');

// configura una enlace "Agregar una etiqueta"
var $addTagLinkBen = $('<a href="#" class="add_tag_link btn tool" title="Agregar beneficiario"><i class="icon-plus-sign"></i></a>');
var $newLinkLiBen = $('<ul></ul>').append($addTagLinkBen);

jQuery(document).ready(function() {
    // Añade el ancla "Agregar una etiqueta" y las etiquetas li y ul
    collectionHolderBen.append($newLinkLiBen);

    // Añade un enlace para eliminar todas las etiquetas existentes
    // en elementos li del formulario
    collectionHolderBen.find('li').each(function() {
        addTagFormDeleteLink($(this));
    });

    // cuenta las entradas actuales en el formulario (p. ej. 2),
    // la usa como índice al insertar un nuevo elemento (p. ej. 2)
    collectionHolderBen.data('index', collectionHolderBen.find(':input').length);

    $addTagLinkBen.on('click', function(e) {
        // evita crear el enlace con una "#" en la URL
        e.preventDefault();

        // añade una nueva etiqueta form (ve el siguiente bloque de código)
        addTagForm(collectionHolderBen, $newLinkLiBen);
    });
});
</script>

{% endblock %}



